#!/bin/bash

# --------------------------------------------------
# "PARTITIONIEREN WENN BENÖTIGT"
# cgdisk
#
# efi = ef00
# swap = 8200
# linux = 8300
 
# "FORMATIEREN WENN BENÖTIGT"
# z.B :
#    mkfs.fat -F32 /dev/…
#    mkfs.btrfs /dev/...
#    mkswap /dev/...
#    mkfs.ext4 /dev/...
# 
# -------------------------------------------------
# mount -o umask=0077 /dev/…  /mnt/boot
# mount -o defaults,noatime,discard /dev/… /mnt
# mount -o defaults,noatime,discard /dev/… /mnt/home
# swapon /dev/...
# --------------------------------------------------------------

#loadkeys de-latin1

read -p "Bitte Festplatte für die installation angeben: " HDD
cgdisk /dev/$HDD

BOOT_HD="${HDD}1"
SWAP_HD="${HDD}2"
ROOT_HD="${HDD}3"
HOME_HD="${HDD}4"

# formating partitions
mkfs.fat -F32 /dev/$BOOT_HD
mkswap /dev/$SWAP_HD
mkfs.ext4 /dev/$ROOT_HD
mkfs.ext4 /dev/$HOME_HD

# Mounting partitions
mount /dev/$ROOT_HD /mnt
mkdir /mnt/boot
mkdir /mnt/boot/efi
mount /dev/$BOOT_HD /mnt/boot/efi
mkdir /mnt/home
mount /dev/$HOME_HD /mnt/home
swapon /dev/$SWAP_HD

# Install base pacages
pacstrap -i /mnt base base-devel linux-headers grub os-prober efibootmgr bash-completion acpid dbus ranger git htop
#Install Network pakages
pacstrap -i /mnt avahi networkmanager network-manager-applet nm-connection-editor ntp
#Install Audio pakages
pacstrap -i /mnt pulseaudio alsa-tools alsa-utils pulseaudio-alsa pavucontrol flac volumeicon
#Install Video pakages
pacstrap -i /mnt xf86-input-keyboard xorg-server xorg-xinit compton ffmpeg
#Install GUI pakages
pacstrap -i /mnt i3 xfce4 xfce4-goodies lightdm lightdm-gtk-greeter
#Install Additional apps
pacstrap -i /mnt xfce4-appfinder chromium qt5 vlc mpv audacious hunspell-de polkit-gnome nitrogen rofi conky atom nemo
#Install Themes
pacstrap -i /mnt arc-gtk-theme arc-icon-theme adwaita-icon-theme noto-fonts awesome-terminal-fonts

# Generate fstab
genfstab -U -p /mnt >> /mnt/etc/fstab
 
arch-chroot /mnt

